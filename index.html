<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Komfi Vitalita ‚Äì Prototyp</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Gambarino - display/heading font */
    @font-face {
      font-family: 'Gambarino';
      src: url('/fonts/Gambarino_Complete/Fonts/WEB/fonts/Gambarino-Regular.woff2') format('woff2'),
           url('/fonts/Gambarino_Complete/Fonts/WEB/fonts/Gambarino-Regular.woff') format('woff');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    /* Satoshi - body font */
    @font-face {
      font-family: 'Satoshi';
      src: url('/fonts/Satoshi_Complete/Fonts/WEB/fonts/Satoshi-Variable.woff2') format('woff2'),
           url('/fonts/Satoshi_Complete/Fonts/WEB/fonts/Satoshi-Variable.woff') format('woff');
      font-weight: 300 900;
      font-style: normal;
      font-display: swap;
    }

    /* Light theme (default) */
    :root {
      --color-bg: #f7f5f0;
      --color-bg-secondary: #ebe8e1;
      --color-bg-card: #ffffff;
      --color-bg-card-hover: #fdfcfa;
      --color-bg-input: #f7f5f0;
      --color-bg-tag: #f7f5f0;
      --color-bg-sticky: rgba(247, 245, 240, 0.95);

      --color-text-primary: #2d2d2d;
      --color-text-secondary: #4a4a4a;
      --color-text-muted: #8a8279;
      --color-text-subtle: #a69f94;

      --color-border: #e8e5de;
      --color-border-light: #f7f5f0;

      --color-terracotta: #c67c4e;
      --color-terracotta-dark: #a86639;
      --color-terracotta-light: #d4956b;
      --color-terracotta-bg: rgba(198, 124, 78, 0.1);
      --color-terracotta-hover: rgba(198, 124, 78, 0.04);

      --color-sage: #9caa97;
      --color-sage-bg: rgba(156, 170, 151, 0.1);

      --color-summary-bg: #2d2d2d;
      --color-summary-text: #ffffff;

      --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.05);
      --shadow-hover: 0 12px 40px -12px rgba(45, 45, 45, 0.12);

      --grain-opacity: 0.03;
      --grain-blend: multiply;
    }

    /* Dark theme */
    .dark {
      --color-bg: #141414;
      --color-bg-secondary: #1a1a1a;
      --color-bg-card: #1e1e1e;
      --color-bg-card-hover: #252525;
      --color-bg-input: #252525;
      --color-bg-tag: #2a2a2a;
      --color-bg-sticky: rgba(20, 20, 20, 0.95);

      --color-text-primary: #f5f5f5;
      --color-text-secondary: #d4d4d4;
      --color-text-muted: #a3a3a3;
      --color-text-subtle: #737373;

      --color-border: #2e2e2e;
      --color-border-light: #252525;

      --color-terracotta: #d4956b;
      --color-terracotta-dark: #c67c4e;
      --color-terracotta-light: #e0a87d;
      --color-terracotta-bg: rgba(212, 149, 107, 0.15);
      --color-terracotta-hover: rgba(212, 149, 107, 0.08);

      --color-sage: #b0c4ab;
      --color-sage-bg: rgba(176, 196, 171, 0.15);

      --color-summary-bg: #252525;
      --color-summary-text: #f5f5f5;

      --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.3);
      --shadow-hover: 0 12px 40px -12px rgba(0, 0, 0, 0.5);

      --grain-opacity: 0.02;
      --grain-blend: overlay;
    }

    * {
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      margin: 0;
      font-family: 'Satoshi', system-ui, sans-serif;
      background-color: var(--color-bg);
      color: var(--color-text-primary);
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .font-display {
      font-family: 'Gambarino', Georgia, serif;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: var(--color-bg-secondary); }
    ::-webkit-scrollbar-thumb { background: var(--color-text-subtle); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--color-text-muted); }

    /* Grain overlay */
    .grain-overlay { position: relative; }
    .grain-overlay::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: var(--grain-opacity);
      pointer-events: none;
      mix-blend-mode: var(--grain-blend);
    }

    /* Animations */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.96); }
      to { opacity: 1; transform: scale(1); }
    }
    .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
    .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    .animate-scale-in { animation: scaleIn 0.4s ease-out forwards; }

    /* Staggered animations */
    .stagger-1 { animation-delay: 0.05s; }
    .stagger-2 { animation-delay: 0.1s; }
    .stagger-3 { animation-delay: 0.15s; }
    .stagger-4 { animation-delay: 0.2s; }

    /* Card hover */
    .card-hover { transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .card-hover:hover { transform: translateY(-2px); box-shadow: var(--shadow-hover); }

    /* Decorative line */
    .decorative-line {
      width: 48px;
      height: 2px;
      background: linear-gradient(90deg, var(--color-terracotta), var(--color-terracotta-light));
    }

    /* Theme toggle */
    .theme-toggle {
      position: relative;
      width: 44px;
      height: 24px;
      background: var(--color-border);
      border-radius: 12px;
      transition: background-color 0.3s ease;
      cursor: pointer;
      border: none;
    }
    .theme-toggle::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: var(--color-bg-card);
      border-radius: 50%;
      transition: transform 0.3s ease, background-color 0.3s ease;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }
    .dark .theme-toggle { background: var(--color-terracotta); }
    .dark .theme-toggle::after { transform: translateX(20px); }

    /* Selection */
    ::selection { background-color: var(--color-terracotta); color: white; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, createContext, useContext } = React;

    // ============================================
    // DARK MODE CONTEXT
    // ============================================

    const ThemeContext = createContext();

    const ThemeProvider = ({ children }) => {
      const [isDark, setIsDark] = useState(() => {
        if (typeof window !== 'undefined') {
          const saved = localStorage.getItem('vitalita-theme');
          if (saved) return saved === 'dark';
          return window.matchMedia('(prefers-color-scheme: dark)').matches;
        }
        return false;
      });

      useEffect(() => {
        document.documentElement.classList.toggle('dark', isDark);
        localStorage.setItem('vitalita-theme', isDark ? 'dark' : 'light');
      }, [isDark]);

      const toggleTheme = () => setIsDark(!isDark);

      return (
        <ThemeContext.Provider value={{ isDark, toggleTheme }}>
          {children}
        </ThemeContext.Provider>
      );
    };

    const useTheme = () => useContext(ThemeContext);

    // Theme Toggle Component
    const ThemeToggle = () => {
      const { isDark, toggleTheme } = useTheme();
      return (
        <button
          onClick={toggleTheme}
          className="theme-toggle"
          aria-label={isDark ? 'Switch to light mode' : 'Switch to dark mode'}
        />
      );
    };

    // Komfi Logo
    const KomfiLogo = ({ className = '' }) => (
      <svg className={className} viewBox="0 0 569.75 170.24" fill="currentColor">
        <path d="m502.11,7.86c7.82,0,15.68,4.28,15.68,20.12,0,10.4,8.43,18.82,18.82,18.82s18.82-8.43,18.82-18.82c0,0,2.32-27.32-49.79-27.47-.14-.02-.28-.04-.43-.04-.13,0-.26.03-.39.04h-2.72c-24.85,0-49.9,20.84-49.9,46.59v18.93h-8.71c-1.83,0-3.53,1.25-3.82,3.06-.37,2.3,1.39,4.29,3.62,4.29.34,0,.67.04.99.1h2.99c2.72,0,4.93,2.21,4.93,4.93v68.59c0,6.89-5.59,12.48-12.47,12.48h-3.57c-6.89,0-12.48-5.59-12.48-12.48v-54.59c0-18.44-7.23-38.38-30.91-38.38-13.61,0-23.92,6.31-31.81,15.02-3.27,3.5-5.51,6.82-6.4,8.22-.28.43-.75.7-1.26.7-.67,0-1.25-.45-1.44-1.09-.82-3.28-1.98-6.36-3.54-9.13-.02-.04-.05-.08-.07-.12-4.6-8.11-12.53-13.58-24.77-13.58-16.84,0-29.37,10.26-39.25,23.09-.4.53-1.02.84-1.69.84-1.45,0-2.48-1.42-2.04-2.8l5.32-16.55c.31-.97.04-2.04-.7-2.74l-2.23-2.12c-.9-.86-2.28-.96-3.32-.27-9.98,6.63-19.1,10.51-33.37,12.9-1.29.22-2.25,1.32-2.25,2.62,0,1.47,1.21,2.65,2.68,2.65,12.03,0,13.77,4.9,13.77,13.28v62.07c0,10.07-5.05,11.52-13.98,13.04-1.42.24-2.47,1.48-2.47,2.92h0c0,1.65,1.33,2.98,2.97,2.98h49.9c1.64,0,2.97-1.33,2.97-2.97v-.06c0-1.42-1.02-2.65-2.42-2.91-7.92-1.51-13.28-3.02-13.28-13v-60.82c9.97-13.21,20.69-16.2,27.67-16.2,11.96,0,18.45,8.97,18.45,23.67v53.34c0,10.09-5.06,11.53-14.21,13.05-1.43.24-2.48,1.48-2.48,2.93,0,1.64,1.33,2.97,2.97,2.97h50.65c1.64,0,2.97-1.33,2.97-2.97v-.02c0-1.44-1.05-2.67-2.46-2.92-8.71-1.52-13.74-2.98-13.74-13.03v-60.82c10.22-13.21,19.94-16.2,27.42-16.2,12.71,0,18.69,8.97,18.69,23.67v53.34c0,10.09-5.07,11.53-14.03,13.05-1.39.24-2.42,1.45-2.42,2.86v.13c0,1.6,1.3,2.9,2.9,2.9h113.2c1.6,0,2.9-1.3,2.9-2.9,0-1.47-1.1-2.71-2.57-2.88-13.6-1.57-23.11-2.83-23.11-13.16v-73.52h0v-.1h19.81c1.83,0,3.53-1.25,3.82-3.06.37-2.3-1.39-4.29-3.62-4.29h-14.79c-2.93,0-5.31-2.38-5.31-5.31v-19.46c0-27.45,16.69-33.4,25.31-33.4Z"/>
        <path d="m567.28,160.02c-8.56-1.51-13.98-2.99-13.98-13.03V61.75c0-.82-.35-1.61-.96-2.17l-2.51-2.28c-1.03-.93-2.44-.81-3.68-.19-12.21,6.17-18.61,6.98-30.55,9.19-1.4.26-2.43,1.45-2.43,2.87s1.05,2.65,2.46,2.88c12.23,2.01,13.99,6.91,13.99,15.35v59.57c0,10.03-5.42,11.51-13.98,13.03-1.42.25-2.47,1.49-2.47,2.94,0,1.65,1.34,2.98,2.98,2.98h50.61c1.65,0,2.98-1.33,2.98-2.98,0-1.44-1.05-2.68-2.47-2.94Z"/>
        <path d="m184.67,52.43c-33.05,0-59.85,26.37-59.85,58.9s26.79,58.9,59.85,58.9,59.85-26.37,59.85-58.9-26.79-58.9-59.85-58.9Zm0,106.93c-19.08,0-34.55-21.5-34.55-48.02s15.47-48.02,34.55-48.02,34.55,21.5,34.55,48.02-15.47,48.02-34.55,48.02Z"/>
        <path d="m83.7,92.35h15.71c11.02,0,19.96-8.94,19.96-19.96h0c0-11.02-8.94-19.96-19.96-19.96h0c-11.02,0-19.96,8.94-19.96,19.96v15.71c0,2.35,1.9,4.25,4.25,4.25Z"/>
        <path d="m129.98,160.15c-13.18-8.72-33.57-34.13-45.77-50.2-6.55-8.63-11.48-13.73-22.29-13.84h-5.24s-.35-.01-.35-.01h-12.55V5.71c0-.88-.36-1.72-1-2.33l-2.62-2.49c-1.07-1.01-2.69-1.18-3.93-.38C25.33,7.63,16.68,11.64,2.77,14.24c-1.23.23-2.32,1.09-2.65,2.31-.52,1.91.73,3.75,2.56,4.04,13.67,2.2,17.31,7.6,17.31,16.88v107.66c0,11.03-4.43,12.65-14.12,14.32-1.77.3-3.01,1.99-2.66,3.84.29,1.58,1.78,2.66,3.39,2.66h49.9c1.61,0,3.1-1.08,3.39-2.66.34-1.84-.9-3.53-2.66-3.84-9.69-1.67-13.44-3.28-13.44-14.32v-38.11c.06-3.47,4.49-4.93,6.58-2.13l7.91,10.55v-.08c9.19,12.19,20.41,27.01,26.17,34.41,2.68,3.44,11.86,16.17,24.11,16.17h20.02c3.01,0,3.91-4.13,1.4-5.79Z"/>
      </svg>
    );

    // ============================================
    // DATA - Biomarkery a bal√≠ƒçky
    // ============================================

    const biomarkers = {
      zakladni: {
        name: "Z√°kladn√≠ stabilita",
        question: "Dr≈æ√≠ tƒõlo rezervy?",
        focus: ["V√Ω≈æiva", "Z√°nƒõt", "Z√°kladn√≠ metabolismus"],
        markers: [
          { name: "Krevn√≠ obraz", category: "blood", why: "An√©mie, infekce, imunita", youWillSee: "Poƒçet ƒçerven√Ωch a b√≠l√Ωch krvinek. Uvid√≠te, jestli m√°te dost kysl√≠ku v krvi a jak pracuje imunitn√≠ syst√©m." },
          { name: "CRP", category: "inflammation", why: "Z√°nƒõt v tƒõle", youWillSee: "ƒå√≠slo 0-10+. Pod 3 = OK, nad 10 = akutn√≠ z√°nƒõt. Trend uk√°≈æe, jestli se z√°nƒõt zhor≈°uje." },
          { name: "Albumin", category: "nutrition", why: "Stav v√Ω≈æivy, funkce jater", youWillSee: "Hodnota v g/L. Pod 35 = mo≈æn√° podv√Ω≈æiva nebo probl√©m s j√°try. D≈Øle≈æit√© pro seniory." },
          { name: "Gluk√≥za", category: "diabetes", why: "Cukrovka screening", youWillSee: "Hladina cukru nalaƒçno v mmol/L. Nad 7 = prediabetes. Semafor zelen√°/oran≈æov√°/ƒçerven√°." },
          { name: "Kreatinin + GFR", category: "kidney", why: "Funkce ledvin", youWillSee: "GFR ƒç√≠slo 0-120. Nad 60 = OK, pod 60 = pozor na ledviny. Trend je kl√≠ƒçov√Ω." },
          { name: "Vitamin D", category: "vitamin", why: "Kosti, imunita, n√°lada", youWillSee: "Hladina v nmol/L. Pod 50 = nedostatek (ƒçast√© v ƒåR). Doporuƒçen√≠ kolik doplnit." }
        ]
      },
      rizika: {
        name: "Rizika n√°hl√Ωch zlom≈Ø",
        question: "Hroz√≠ infarkt, mrtvice nebo diabetes?",
        focus: ["Srdce a c√©vy", "Cukr", "Krevn√≠ tlak"],
        markers: [
          { name: "Cholesterol celkov√Ω", category: "lipid", why: "Kardio riziko", youWillSee: "Celkov√° hladina cholesterolu v mmol/L. Nad 5 = zv√Ω≈°en√© riziko. Ale d≈Øle≈æitƒõj≈°√≠ je pomƒõr LDL/HDL." },
          { name: "LDL cholesterol", category: "lipid", why: "'≈†patn√Ω' cholesterol", youWillSee: "Hladina '≈°patn√©ho' cholesterolu. Nad 3 = riziko ucp√°v√°n√≠ c√©v. ƒå√≠m ni≈æ≈°√≠, t√≠m lep≈°√≠." },
          { name: "HDL cholesterol", category: "lipid", why: "'Dobr√Ω' cholesterol", youWillSee: "Hladina 'dobr√©ho' cholesterolu. Nad 1,2 u ≈æen, nad 1,0 u mu≈æ≈Ø = OK. Chr√°n√≠ c√©vy." },
          { name: "Triglyceridy", category: "lipid", why: "Tuky v krvi", youWillSee: "Tuky z j√≠dla v krvi. Pod 1,7 = OK. Vysok√© hodnoty = riziko infarktu." },
          { name: "HbA1c", category: "diabetes", why: "Dlouhodob√Ω cukr (3 mƒõs√≠ce)", youWillSee: "Pr≈Ømƒõrn√° hladina cukru za 3 mƒõs√≠ce. Pod 42 = OK, 42-47 = prediabetes, nad 48 = diabetes." },
          { name: "Krevn√≠ tlak", category: "cardio", why: "Hypertenze", youWillSee: "Systolick√Ω/diastolick√Ω tlak (nap≈ô. 130/85). Nad 140/90 = hypertenze. Trend je d≈Øle≈æit√Ω." }
        ]
      },
      komplexni: {
        name: "Komplexn√≠ dohled",
        question: "Dƒõje se nƒõco skryt√©ho?",
        focus: ["Org√°ny", "Komplikace", "Skryt√© poruchy"],
        markers: [
          { name: "ALT + AST", category: "liver", why: "J√°tra - po≈°kozen√≠", youWillSee: "Jatern√≠ enzymy v U/L. Nad 45 = mo≈æn√© po≈°kozen√≠ jater. Ukazuje i probl√©my z l√©k≈Ø." },
          { name: "GGT + ALP + Bilirubin", category: "liver", why: "J√°tra komplet", youWillSee: "Kompletn√≠ obraz funkce jater a ≈æluƒçov√Ωch cest. Bilirubin nad 21 = ≈æloutenka." },
          { name: "TSH + fT4", category: "thyroid", why: "≈†t√≠tn√° ≈æl√°za", youWillSee: "TSH pod 0,4 = zrychlen√° ≈°t√≠tn√° ≈æl√°za, nad 4 = pomal√°. fT4 ukazuje aktivitu." },
          { name: "Miner√°ly (Na, K, Ca, Mg)", category: "mineral", why: "Srdce, svaly, hydratace", youWillSee: "Hladiny kl√≠ƒçov√Ωch miner√°l≈Ø. Nerovnov√°ha = k≈ôeƒçe, √∫nava, srdeƒçn√≠ probl√©my." },
          { name: "Moƒç chemicky + sediment", category: "kidney", why: "Ledviny, infekce", youWillSee: "Rozbor moƒçi - b√≠lkoviny, krev, bakterie. Ukazuje infekce a probl√©my ledvin." },
          { name: "B12 + Fol√°t", category: "vitamin", why: "Energie, nervy, pamƒõ≈•", youWillSee: "B12 pod 200 = nedostatek (ƒçast√© u senior≈Ø). Zp≈Øsobuje √∫navu a probl√©my s pamƒõt√≠." },
          { name: "Ferritin", category: "blood", why: "Z√°soby ≈æeleza", youWillSee: "Z√°soby ≈æeleza v tƒõle. Pod 30 = vyƒçerpan√© z√°soby, nad 300 = p≈ôebytek (riziko)." },
          { name: "PSA (mu≈æi)", category: "prostate", why: "Prostata screening", youWillSee: "Marker prostaty. Pod 4 = OK, nad 4 = doporuƒçen√° kontrola u urologa. Trend je kl√≠ƒçov√Ω." }
        ]
      }
    };

    // ============================================
    // Kategorie mƒõ≈ôen√≠ s cenami add-on≈Ø
    // ============================================

    const measurementCategories = {
      krev: {
        id: 'krev',
        name: 'KREV',
        emoji: 'ü©∏',
        description: 'Krevn√≠ testy',
        baseIncluded: true, // v≈ædy zahrnuto
        addonPrice: 0
      },
      telMereni: {
        id: 'telMereni',
        name: 'TƒöL. Mƒö≈òEN√ç',
        emoji: 'üìè',
        description: 'Tlak, InBody anal√Ωza',
        baseIncluded: false,
        addonPrice: 290
      },
      grip: {
        id: 'grip',
        name: 'GRIP',
        emoji: '‚úä',
        description: 'S√≠la stisku ruky',
        baseIncluded: false,
        addonPrice: 190
      },
      kognitivni: {
        id: 'kognitivni',
        name: 'KOGNITIVN√ç TESTY',
        emoji: 'üß†',
        description: 'Pamƒõ≈• a pozornost',
        baseIncluded: false,
        addonPrice: 390
      }
    };

    // Fyzick√° mƒõ≈ôen√≠ - stup≈àovanƒõ podle bal√≠ƒçk≈Ø
    const physicalMeasurements = {
      bloodPressure: {
        id: 'bloodPressure',
        name: "Krevn√≠ tlak a tep",
        emoji: "üíì",
        what: "Systolick√Ω/diastolick√Ω tlak, tepov√° frekvence",
        youWillSee: "ƒå√≠sla tlaku (nap≈ô. 130/85) + zda je v normƒõ pro v√°≈° vƒõk. Trend oproti minul√©mu mƒõ≈ôen√≠.",
        why: "Vysok√Ω tlak = tich√Ω zabij√°k, ƒçasto bez p≈ô√≠znak≈Ø"
      },
      gripStrength: {
        id: 'gripStrength',
        name: "S√≠la stisku ruky",
        emoji: "‚úä",
        what: "Dynamometr mƒõ≈ô√≠ s√≠lu v kg",
        youWillSee: "Va≈°e s√≠la v kg + porovn√°n√≠ s pr≈Ømƒõrem pro v√°≈° vƒõk a pohlav√≠. Trend v ƒçase.",
        why: "Indik√°tor k≈ôehkosti a rizika p√°d≈Ø u senior≈Ø"
      },
      inbody: {
        id: 'inbody',
        name: "InBody anal√Ωza",
        emoji: "‚öñÔ∏è",
        what: "Slo≈æen√≠ tƒõla - svaly, tuk, voda",
        youWillSee: "Kolik kg sval≈Ø, tuku a vody m√°te. Srovn√°n√≠ s ide√°lem pro v√°≈° vƒõk. Trend √∫bytku sval≈Ø.",
        why: "Svalov√° hmota kles√° s vƒõkem ‚Üí riziko p√°d≈Ø a k≈ôehkosti"
      }
    };

    // ============================================
    // NOV√â: Personalizovan√© profily podle person
    // ============================================

    const profiles = {
      kardio: {
        id: 'kardio',
        name: 'KARDIO',
        emoji: 'üí™',
        tagline: 'Prevence infarktu a diabetu',
        basePrice: 990,
        color: '#3B82F6',
        concerns: ['Cukrovka v rodinƒõ', 'Cholesterol', 'Chci z≈Østat fit'],
        markers: [
          // Z√°klad
          { name: "Krevn√≠ obraz", category: "blood", why: "An√©mie, infekce, imunita", youWillSee: "Poƒçet ƒçerven√Ωch a b√≠l√Ωch krvinek. Uvid√≠te, jestli m√°te dost kysl√≠ku v krvi." },
          { name: "CRP", category: "inflammation", why: "Z√°nƒõt v tƒõle", youWillSee: "ƒå√≠slo 0-10+. Pod 3 = OK, nad 10 = z√°nƒõt. Chronick√Ω z√°nƒõt zvy≈°uje kardio riziko." },
          { name: "Gluk√≥za", category: "diabetes", why: "Cukrovka screening", youWillSee: "Hladina cukru nalaƒçno. Nad 7 = prediabetes. Semafor zelen√°/oran≈æov√°/ƒçerven√°." },
          { name: "Kreatinin + GFR", category: "kidney", why: "Funkce ledvin", youWillSee: "GFR ƒç√≠slo 0-120. Nad 60 = OK. Ledviny trp√≠ p≈ôi cukrovce." },
          // Kardio - hlavn√≠ focus
          { name: "Cholesterol celkov√Ω", category: "lipid", why: "Kardio riziko", youWillSee: "Celkov√° hladina v mmol/L. Nad 5 = zv√Ω≈°en√© riziko." },
          { name: "LDL cholesterol", category: "lipid", why: "'≈†patn√Ω' cholesterol", youWillSee: "Hladina '≈°patn√©ho' cholesterolu. Nad 3 = riziko ucp√°v√°n√≠ c√©v." },
          { name: "HDL cholesterol", category: "lipid", why: "'Dobr√Ω' cholesterol", youWillSee: "Chr√°n√≠ c√©vy. Nad 1,0 u mu≈æ≈Ø, nad 1,2 u ≈æen = OK." },
          { name: "Triglyceridy", category: "lipid", why: "Tuky v krvi", youWillSee: "Pod 1,7 = OK. Vysok√© = riziko infarktu." },
          { name: "HbA1c", category: "diabetes", why: "Dlouhodob√Ω cukr", youWillSee: "Pr≈Ømƒõr za 3 mƒõs√≠ce. Pod 42 = OK, 42-47 = prediabetes." },
          // Vitam√≠ny
          { name: "Vitamin D", category: "vitamin", why: "Kosti, imunita", youWillSee: "Pod 50 nmol/L = nedostatek. ƒåast√© v ƒåR, hlavnƒõ v zimƒõ." }
        ],
        physicalMeasurementIds: ['bloodPressure'],
        output: ['Kardio sk√≥re', 'Diabetes riziko', 'Trend report', 'Doporuƒçen√≠']
      },
      energie: {
        id: 'energie',
        name: 'ENERGIE',
        emoji: 'üè†',
        tagline: 'Energie, pamƒõ≈• a vitalita',
        basePrice: 1290,
        color: '#10B981',
        concerns: ['√önava a energie', 'Krevn√≠ tlak', 'Pamƒõ≈•'],
        markers: [
          // Z√°klad
          { name: "Krevn√≠ obraz", category: "blood", why: "An√©mie = √∫nava", youWillSee: "Hemoglobin pod 120 u ≈æen, 130 u mu≈æ≈Ø = an√©mie. ƒåast√° p≈ô√≠ƒçina √∫navy." },
          { name: "CRP", category: "inflammation", why: "Chronick√Ω z√°nƒõt", youWillSee: "Z√°nƒõt vys√°v√° energii. Pod 3 = OK." },
          { name: "Gluk√≥za", category: "diabetes", why: "Kol√≠s√°n√≠ energie", youWillSee: "Vysok√Ω cukr = √∫nava po j√≠dle, kol√≠s√°n√≠ energie." },
          { name: "Kreatinin + GFR", category: "kidney", why: "Ledviny a √∫nava", youWillSee: "≈†patn√© ledviny = hromadƒõn√≠ toxin≈Ø = √∫nava." },
          // Kardio
          { name: "Cholesterol celkov√Ω", category: "lipid", why: "Kardio riziko", youWillSee: "Nad 5 = zv√Ω≈°en√© riziko." },
          { name: "LDL cholesterol", category: "lipid", why: "'≈†patn√Ω' cholesterol", youWillSee: "Nad 3 = riziko ucp√°v√°n√≠ c√©v." },
          { name: "HDL cholesterol", category: "lipid", why: "'Dobr√Ω' cholesterol", youWillSee: "Chr√°n√≠ c√©vy." },
          { name: "Triglyceridy", category: "lipid", why: "Tuky v krvi", youWillSee: "Pod 1,7 = OK." },
          { name: "HbA1c", category: "diabetes", why: "Dlouhodob√Ω cukr", youWillSee: "Pr≈Ømƒõr za 3 mƒõs√≠ce." },
          // Energie - hlavn√≠ focus
          { name: "B12 + Fol√°t", category: "vitamin", why: "Energie, pamƒõ≈•", youWillSee: "B12 pod 200 = nedostatek. Zp≈Øsobuje √∫navu, probl√©my s pamƒõt√≠." },
          { name: "Ferritin", category: "blood", why: "Z√°soby ≈æeleza", youWillSee: "Pod 30 = vyƒçerpan√© z√°soby. √önava i bez an√©mie." },
          { name: "TSH + fT4", category: "thyroid", why: "≈†t√≠tn√° ≈æl√°za", youWillSee: "TSH nad 4 = pomal√° ≈°t√≠tn√° ≈æl√°za = √∫nava, p≈ôib√≠r√°n√≠. Pod 0,4 = rychl√°." },
          { name: "Albumin", category: "nutrition", why: "V√Ω≈æiva", youWillSee: "Pod 35 g/L = mo≈æn√° podv√Ω≈æiva. D≈Øle≈æit√© pro energii." },
          { name: "Vitamin D", category: "vitamin", why: "Energie, n√°lada", youWillSee: "Pod 50 = nedostatek. Zp≈Øsobuje √∫navu a ≈°patnou n√°ladu." }
        ],
        physicalMeasurementIds: ['bloodPressure'],
        output: ['Energie report', '≈†t√≠tn√° ≈æl√°za check', 'Trend + doporuƒçen√≠', 'Sync s Bistro']
      },
      krehkost: {
        id: 'krehkost',
        name: 'K≈òEHKOST',
        emoji: 'üë®‚Äçüë©‚Äçüëß',
        tagline: 'Komplexn√≠ monitoring a prevence p√°d≈Ø',
        basePrice: 1690,
        color: '#EF4444',
        concerns: ['K≈ôehkost a p√°dy', 'V√Ω≈æiva', 'Komplexn√≠ p≈ôehled'],
        markers: [
          // Z√°klad
          { name: "Krevn√≠ obraz", category: "blood", why: "An√©mie, infekce", youWillSee: "Kompletn√≠ krevn√≠ obraz s diferenci√°lem." },
          { name: "CRP", category: "inflammation", why: "Z√°nƒõt", youWillSee: "Chronick√Ω z√°nƒõt zhor≈°uje k≈ôehkost." },
          { name: "Gluk√≥za", category: "diabetes", why: "Cukrovka", youWillSee: "Diabetes zhor≈°uje hojen√≠ a s√≠lu." },
          { name: "Kreatinin + GFR", category: "kidney", why: "Ledviny", youWillSee: "Funkce ledvin - d≈Øle≈æit√© pro l√©ky." },
          { name: "HbA1c", category: "diabetes", why: "Dlouhodob√Ω cukr", youWillSee: "Pr≈Ømƒõr za 3 mƒõs√≠ce." },
          // Energie
          { name: "B12 + Fol√°t", category: "vitamin", why: "Nervy, pamƒõ≈•", youWillSee: "Nedostatek = probl√©my s ch≈Øz√≠ a pamƒõt√≠." },
          { name: "Ferritin", category: "blood", why: "≈Ωelezo", youWillSee: "Z√°soby ≈æeleza." },
          { name: "TSH + fT4", category: "thyroid", why: "≈†t√≠tn√° ≈æl√°za", youWillSee: "Ovliv≈àuje energii a metabolismus." },
          // V√Ω≈æiva - hlavn√≠ focus
          { name: "Albumin", category: "nutrition", why: "Stav v√Ω≈æivy", youWillSee: "Kl√≠ƒçov√Ω marker podv√Ω≈æivy u senior≈Ø. Pod 35 = riziko." },
          { name: "Vitamin D", category: "vitamin", why: "Kosti, svaly", youWillSee: "Nedostatek = slab√© kosti a svaly = p√°dy." },
          { name: "Miner√°ly (Na, K, Ca, Mg)", category: "mineral", why: "Svaly, hydratace", youWillSee: "Nerovnov√°ha = k≈ôeƒçe, slabost, p√°dy." },
          // Org√°ny
          { name: "ALT + AST", category: "liver", why: "J√°tra", youWillSee: "Funkce jater - d≈Øle≈æit√© pro metabolismus l√©k≈Ø." },
          { name: "GGT + ALP + Bilirubin", category: "liver", why: "J√°tra komplet", youWillSee: "Kompletn√≠ jatern√≠ panel." },
          { name: "Moƒç chemicky", category: "kidney", why: "Ledviny, infekce", youWillSee: "Infekce moƒçov√Ωch cest jsou ƒçast√© u senior≈Ø." }
        ],
        physicalMeasurementIds: ['bloodPressure', 'gripStrength', 'inbody'],
        output: ['Komplexn√≠ report', 'K≈ôehkost sk√≥re', '15min konzultace', 'Sd√≠len√≠ s l√©ka≈ôem']
      }
    };

    // Frekvence s cenami
    const frequencies = [
      { id: '1x', label: '1√ó roƒçnƒõ', shortLabel: '1√ó', multiplier: 1, discount: 0, description: 'Roƒçn√≠ check-up' },
      { id: '2x', label: '2√ó roƒçnƒõ', shortLabel: '2√ó', multiplier: 2, discount: 0.1, description: 'Sledov√°n√≠ trendu' },
      { id: '4x', label: '4√ó roƒçnƒõ', shortLabel: '4√ó', multiplier: 4, discount: 0.2, description: 'Intenzivn√≠ monitoring' }
    ];

    // V√Ωpoƒçet ceny
    const calculatePrice = (profile, frequency) => {
      const base = profile.basePrice * frequency.multiplier;
      return Math.round(base * (1 - frequency.discount));
    };

    // Mapov√°n√≠ persona ‚Üí profil
    const personaToProfile = {
      'young': 'kardio',
      'senior': 'energie',
      'family': 'krehkost',
      'fragile': 'krehkost'
    };

    const personas = [
      {
        id: 'young',
        emoji: 'üí™',
        title: 'Je mi 50‚Äì65 let',
        subtitle: 'Chci p≈ôedej√≠t infarktu a cukrovce',
        description: 'C√≠t√≠m se dob≈ôe, ale nechci dopadnout jako rodiƒçe.',
        concerns: ['Cukrovka v rodinƒõ', 'Cholesterol', 'Chci z≈Østat fit'],
        profileId: 'kardio',
        color: '#3B82F6'
      },
      {
        id: 'senior',
        emoji: 'üè†',
        title: 'Je mi 65‚Äì75 let',
        subtitle: 'Chci m√≠t energii a z≈Østat samostatn√Ω/√°',
        description: 'Obƒças jsem unaven√Ω/√°. Chci vƒõdƒõt proƒç.',
        concerns: ['√önava a energie', 'Krevn√≠ tlak', 'Pamƒõ≈•'],
        profileId: 'energie',
        color: '#10B981'
      },
      {
        id: 'family',
        emoji: 'üë®‚Äçüë©‚Äçüëß',
        title: 'Star√°m se o rodiƒçe',
        subtitle: 'Chci pro nƒõ klid a jistotu',
        description: 'Boj√≠m se, ≈æe nƒõco p≈ôehl√©dnou. Chci komplexn√≠ p≈ôehled.',
        concerns: ['K≈ôehkost a p√°dy', 'V√Ω≈æiva', 'Komplexn√≠ p≈ôehled'],
        profileId: 'krehkost',
        color: '#8B5CF6'
      },
      {
        id: 'fragile',
        emoji: 'üè•',
        title: 'Zdrav√≠ se zhor≈°uje',
        subtitle: 'Po nemoci nebo hospitalizaci',
        description: 'Pot≈ôebuji pravidelnou kontrolu a dohled.',
        concerns: ['Rekonvalescence', 'Chronick√© nemoci', 'Prevence p√°d≈Ø'],
        profileId: 'krehkost',
        color: '#EF4444'
      }
    ];

    // ============================================
    // NAVIGATION
    // ============================================

    const App = () => {
      const [view, setView] = useState('flow'); // home, mindmap, flow, analysis

      return (
        <ThemeProvider>
          <AppContent view={view} setView={setView} />
        </ThemeProvider>
      );
    };

    const AppContent = ({ view, setView }) => {
      const { isDark } = useTheme();

      return (
        <div className="min-h-screen grain-overlay" style={{ backgroundColor: 'var(--color-bg)' }}>
          {/* Navigation */}
          <nav className="sticky top-0 z-50 border-b" style={{
            backgroundColor: 'var(--color-bg-sticky)',
            backdropFilter: 'blur(12px)',
            borderColor: 'var(--color-border)'
          }}>
            <div className="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
              <div className="flex items-center gap-3">
                <KomfiLogo className="h-5" style={{ color: 'var(--color-text-primary)' }} />
                <span className="font-display text-xl" style={{ color: 'var(--color-terracotta)' }}>
                  Vitalita
                </span>
              </div>
              <div className="flex items-center gap-4">
                <div className="flex gap-1 p-1 rounded-xl" style={{ backgroundColor: 'var(--color-bg-card)', border: '1px solid var(--color-border)' }}>
                  {[
                    { id: 'home', label: 'P≈ôehled' },
                    { id: 'flow', label: 'Objednat' },
                    { id: 'mindmap', label: 'Struktura' },
                    { id: 'analysis', label: 'Anal√Ωza' }
                  ].map(item => (
                    <button
                      key={item.id}
                      onClick={() => setView(item.id)}
                      className="px-4 py-2 rounded-lg text-sm font-medium transition-all"
                      style={{
                        backgroundColor: view === item.id ? 'var(--color-summary-bg)' : 'transparent',
                        color: view === item.id ? 'var(--color-summary-text)' : 'var(--color-text-muted)'
                      }}
                    >
                      {item.label}
                    </button>
                  ))}
                </div>
                <ThemeToggle />
              </div>
            </div>
          </nav>

          {/* Content */}
          <main>
            {view === 'home' && <HomeView onNavigate={setView} />}
            {view === 'mindmap' && <MindmapView />}
            {view === 'flow' && <FlowView />}
            {view === 'analysis' && <AnalysisView />}
          </main>
        </div>
      );
    };

    // ============================================
    // HOME VIEW
    // ============================================

    const HomeView = ({ onNavigate }) => (
      <div className="max-w-5xl mx-auto px-4 py-12 md:py-20">
        <div className="text-center mb-16 animate-fade-in-up">
          <KomfiLogo className="h-8 mx-auto mb-8" style={{ color: 'var(--color-text-primary)' }} />
          <h1 className="font-display text-4xl md:text-5xl lg:text-6xl mb-4" style={{ color: 'var(--color-text-primary)' }}>
            Vitalita
          </h1>
          <p className="text-lg md:text-xl max-w-2xl mx-auto leading-relaxed" style={{ color: 'var(--color-text-muted)' }}>
            Dlouhodob√© sledov√°n√≠ zdrav√≠ z pohodl√≠ domova.
            <br />Pravideln√° mƒõ≈ôen√≠, sledov√°n√≠ trend≈Ø, personalizovan√© doporuƒçen√≠.
          </p>
        </div>

        <div className="grid md:grid-cols-3 gap-6 mb-12">
          {[
            {
              id: 'flow',
              icon: 'üéØ',
              title: 'Objednat slu≈æbu',
              desc: 'Vyberte profil a objednejte si prvn√≠ mƒõ≈ôen√≠'
            },
            {
              id: 'mindmap',
              icon: 'üß†',
              title: 'Struktura slu≈æby',
              desc: 'Interaktivn√≠ mapa profil≈Ø a biomarker≈Ø'
            },
            {
              id: 'analysis',
              icon: 'üìä',
              title: 'Anal√Ωza',
              desc: 'Rozbor bal√≠ƒçk≈Ø, cen a doporuƒçen√≠'
            }
          ].map((item, index) => (
            <button
              key={item.id}
              onClick={() => onNavigate(item.id)}
              className={`p-8 rounded-2xl text-left card-hover animate-fade-in-up stagger-${index + 1}`}
              style={{
                backgroundColor: 'var(--color-bg-card)',
                border: '1px solid var(--color-border)',
                boxShadow: 'var(--shadow-card)'
              }}
            >
              <div
                className="w-14 h-14 rounded-xl flex items-center justify-center text-2xl mb-4"
                style={{ backgroundColor: 'var(--color-terracotta-bg)' }}
              >
                {item.icon}
              </div>
              <h3 className="font-display text-xl mb-2" style={{ color: 'var(--color-text-primary)' }}>{item.title}</h3>
              <p style={{ color: 'var(--color-text-muted)' }}>{item.desc}</p>
            </button>
          ))}
        </div>

        {/* Quick Stats */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 animate-fade-in-up stagger-4">
          {[
            { label: 'Biomarker≈Ø', value: '25+', icon: 'üß™' },
            { label: 'Profil≈Ø', value: '3', icon: 'üì¶' },
            { label: 'Person', value: '4', icon: 'üë•' },
            { label: 'Frekvence', value: '1-4√ó/rok', icon: 'üìÖ' }
          ].map((stat, i) => (
            <div
              key={i}
              className="rounded-xl p-6 text-center"
              style={{
                backgroundColor: 'var(--color-bg-card)',
                border: '1px solid var(--color-border)'
              }}
            >
              <div className="text-2xl mb-2">{stat.icon}</div>
              <div className="font-display text-2xl mb-1" style={{ color: 'var(--color-terracotta)' }}>{stat.value}</div>
              <div className="text-sm" style={{ color: 'var(--color-text-subtle)' }}>{stat.label}</div>
            </div>
          ))}
        </div>
      </div>
    );

    // ============================================
    // MINDMAP VIEW
    // ============================================

    const MindmapView = () => {
      const [expandedNodes, setExpandedNodes] = useState(['root', 'personas', 'concepts', 'packages']);

      const toggleNode = (nodeId) => {
        setExpandedNodes(prev =>
          prev.includes(nodeId)
            ? prev.filter(id => id !== nodeId)
            : [...prev, nodeId]
        );
      };

      const isExpanded = (nodeId) => expandedNodes.includes(nodeId);

      return (
        <div className="max-w-7xl mx-auto px-4 py-8">
          <h2 className="text-3xl font-bold text-slate-800 mb-8 text-center">
            üß† VITALITA ‚Äì Interaktivn√≠ Mindmap
          </h2>

          {/* Root Node */}
          <div className="flex flex-col items-center">
            <div className="bg-gradient-to-br from-emerald-500 to-blue-500 text-white px-8 py-6 rounded-2xl shadow-2xl text-center mb-8">
              <div className="text-4xl mb-2">ü©∫</div>
              <div className="text-2xl font-bold">VITALITA</div>
              <div className="text-emerald-100">Dlouhodob√© sledov√°n√≠ zdrav√≠</div>
            </div>

            {/* Main Branches */}
            <div className="grid md:grid-cols-4 gap-6 w-full">

              {/* Branch 1: Pro koho */}
              <div className="space-y-4">
                <button
                  onClick={() => toggleNode('personas')}
                  className="w-full bg-blue-500 text-white px-6 py-4 rounded-xl font-bold text-lg hover:bg-blue-600 transition-all flex items-center justify-between"
                >
                  <span>üë• Pro koho to je</span>
                  <span>{isExpanded('personas') ? '‚àí' : '+'}</span>
                </button>

                {isExpanded('personas') && (
                  <div className="space-y-3 pl-4 border-l-4 border-blue-300">
                    {personas.map(persona => (
                      <div key={persona.id} className="bg-white rounded-xl p-4 shadow-md border-l-4" style={{borderLeftColor: persona.color}}>
                        <div className="flex items-center gap-3 mb-2">
                          <span className="text-2xl">{persona.emoji}</span>
                          <div>
                            <div className="font-bold text-slate-800">{persona.title}</div>
                            <div className="text-sm text-slate-500">{persona.subtitle}</div>
                          </div>
                        </div>
                        <div className="flex flex-wrap gap-1 mb-2">
                          {persona.concerns.map((c, i) => (
                            <span key={i} className="text-xs px-2 py-1 bg-slate-100 rounded-full text-slate-600">{c}</span>
                          ))}
                        </div>
                        <div className="text-sm font-medium" style={{color: profiles[persona.profileId].color}}>
                          ‚Üí Profil: {profiles[persona.profileId].name}
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>

              {/* Branch 2: Zdravotn√≠ koncepty */}
              <div className="space-y-4">
                <button
                  onClick={() => toggleNode('concepts')}
                  className="w-full bg-emerald-500 text-white px-6 py-4 rounded-xl font-bold text-lg hover:bg-emerald-600 transition-all flex items-center justify-between"
                >
                  <span>üè• Koncepty</span>
                  <span>{isExpanded('concepts') ? '‚àí' : '+'}</span>
                </button>

                {isExpanded('concepts') && (
                  <div className="space-y-3 pl-4 border-l-4 border-emerald-300">
                    {Object.entries(biomarkers).map(([key, concept]) => (
                      <div key={key} className="bg-white rounded-xl p-4 shadow-md">
                        <div className="font-bold text-slate-800 mb-1">{concept.name}</div>
                        <div className="text-sm text-emerald-600 italic mb-2">"{concept.question}"</div>
                        <div className="flex flex-wrap gap-1 mb-2">
                          {concept.focus.map((f, i) => (
                            <span key={i} className="text-xs px-2 py-1 bg-emerald-100 rounded-full text-emerald-700">{f}</span>
                          ))}
                        </div>
                        <div className="text-xs text-slate-500">
                          {concept.markers.length} marker≈Ø
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>

              {/* Branch 3: Profily */}
              <div className="space-y-4">
                <button
                  onClick={() => toggleNode('packages')}
                  className="w-full bg-amber-500 text-white px-6 py-4 rounded-xl font-bold text-lg hover:bg-amber-600 transition-all flex items-center justify-between"
                >
                  <span>üì¶ Profily</span>
                  <span>{isExpanded('packages') ? '‚àí' : '+'}</span>
                </button>

                {isExpanded('packages') && (
                  <div className="space-y-3 pl-4 border-l-4 border-amber-300">
                    {Object.values(profiles).map(profile => (
                      <div key={profile.id} className="bg-white rounded-xl p-4 shadow-md border-l-4" style={{borderLeftColor: profile.color}}>
                        <div className="flex items-center gap-2 mb-2">
                          <span className="text-2xl">{profile.emoji}</span>
                          <div className="font-bold text-slate-800">{profile.name}</div>
                        </div>
                        <div className="text-sm text-slate-600 mb-2">{profile.tagline}</div>
                        <div className="flex justify-between items-center mb-2">
                          <span className="text-lg font-bold" style={{color: profile.color}}>od {profile.basePrice} Kƒç</span>
                          <span className="text-xs text-slate-500">1-4√ó roƒçnƒõ</span>
                        </div>
                        <div className="text-xs text-slate-500">
                          {profile.markers.length} marker≈Ø
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>

              {/* Branch 4: Trend & Frekvence */}
              <div className="space-y-4">
                <button
                  onClick={() => toggleNode('trend')}
                  className="w-full bg-purple-500 text-white px-6 py-4 rounded-xl font-bold text-lg hover:bg-purple-600 transition-all flex items-center justify-between"
                >
                  <span>üìà Trend</span>
                  <span>{isExpanded('trend') ? '‚àí' : '+'}</span>
                </button>

                {isExpanded('trend') && (
                  <div className="space-y-3 pl-4 border-l-4 border-purple-300">
                    <div className="bg-white rounded-xl p-4 shadow-md">
                      <div className="font-bold text-slate-800 mb-2">Proƒç trend?</div>
                      <ul className="text-sm text-slate-600 space-y-1">
                        <li>‚Ä¢ Jednor√°zov√Ω v√Ωsledek nestaƒç√≠</li>
                        <li>‚Ä¢ Zmƒõna v ƒçase je kl√≠ƒçov√°</li>
                        <li>‚Ä¢ Vƒçasn√© zachycen√≠ zhor≈°en√≠</li>
                      </ul>
                    </div>
                    <div className="bg-white rounded-xl p-4 shadow-md">
                      <div className="font-bold text-slate-800 mb-2">Frekvence</div>
                      <div className="space-y-2 text-sm">
                        <div className="flex justify-between">
                          <span className="text-emerald-600">2√ó roƒçnƒõ</span>
                          <span className="text-slate-500">Z√°kladn√≠ trend</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-amber-600">4√ó roƒçnƒõ</span>
                          <span className="text-slate-500">Riziko/zhor≈°ov√°n√≠</span>
                        </div>
                      </div>
                    </div>
                    <div className="bg-purple-100 rounded-xl p-4">
                      <div className="font-bold text-purple-800 mb-1">Princip</div>
                      <div className="text-sm text-purple-700">
                        Ne v√≠c vƒõc√≠, ale <strong>stejn√© vƒõci opakovanƒõ</strong>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>

          {/* Markers Detail */}
          <div className="mt-12">
            <h3 className="text-2xl font-bold text-slate-800 mb-6 text-center">üß™ Detail biomarker≈Ø</h3>
            <div className="grid md:grid-cols-3 gap-6">
              {Object.entries(biomarkers).map(([key, concept]) => (
                <div key={key} className="bg-white rounded-2xl p-6 shadow-lg">
                  <h4 className="font-bold text-lg text-slate-800 mb-2">{concept.name}</h4>
                  <p className="text-emerald-600 italic mb-4">"{concept.question}"</p>
                  <div className="space-y-2">
                    {concept.markers.map((marker, i) => (
                      <div key={i} className="flex items-start gap-3 p-2 hover:bg-slate-50 rounded-lg">
                        <span className="text-lg">
                          {marker.category === 'blood' && 'ü©∏'}
                          {marker.category === 'inflammation' && 'üî•'}
                          {marker.category === 'nutrition' && 'ü•©'}
                          {marker.category === 'diabetes' && 'üç¨'}
                          {marker.category === 'kidney' && 'üíß'}
                          {marker.category === 'vitamin' && '‚òÄÔ∏è'}
                          {marker.category === 'lipid' && '‚ù§Ô∏è'}
                          {marker.category === 'cardio' && 'üíì'}
                          {marker.category === 'liver' && 'ü´Ä'}
                          {marker.category === 'thyroid' && 'ü¶ã'}
                          {marker.category === 'mineral' && 'üíé'}
                          {marker.category === 'prostate' && '‚ôÇÔ∏è'}
                        </span>
                        <div>
                          <div className="font-medium text-slate-800">{marker.name}</div>
                          <div className="text-xs text-slate-500">{marker.why}</div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // ============================================
    // HELPER: Emoji pro kategorii
    // ============================================

    const getCategoryEmoji = (category) => {
      const emojis = {
        blood: 'ü©∏',
        inflammation: 'üî•',
        nutrition: 'ü•©',
        diabetes: 'üç¨',
        kidney: 'üíß',
        vitamin: '‚òÄÔ∏è',
        lipid: '‚ù§Ô∏è',
        cardio: 'üíì',
        liver: 'ü´Ä',
        thyroid: 'ü¶ã',
        mineral: 'üíé',
        prostate: '‚ôÇÔ∏è'
      };
      return emojis[category] || 'üß™';
    };

    // ============================================
    // KOMPONENTA: MarkerCard (NOV√ù DESIGN - label naho≈ôe, marker dole)
    // ============================================

    const MarkerCard = ({ marker, packageColor }) => {
      return (
        <div
          className="p-4 rounded-xl"
          style={{
            backgroundColor: 'var(--color-bg-card)',
            border: '1px solid var(--color-border)'
          }}
        >
          <div className="flex items-start gap-3">
            <span className="text-2xl mt-1">{getCategoryEmoji(marker.category)}</span>
            <div className="flex-1 min-w-0">
              {/* Hlavn√≠ label naho≈ôe - vƒõt≈°√≠ */}
              <div className="font-medium text-base mb-1" style={{ color: 'var(--color-text-primary)' }}>{marker.why}</div>
              {/* Technick√Ω n√°zev dole - men≈°√≠, ≈°ed√Ω */}
              <div className="text-xs mb-2" style={{ color: 'var(--color-text-subtle)' }}>{marker.name}</div>
              {/* Vysvƒõtlen√≠ */}
              {marker.youWillSee && (
                <p className="text-sm leading-relaxed" style={{ color: 'var(--color-text-muted)' }}>{marker.youWillSee}</p>
              )}
            </div>
          </div>
        </div>
      );
    };

    // ============================================
    // KOMPONENTA: PhysicalMeasurementCard (NOV√ù DESIGN - v≈ædy rozbaleno)
    // ============================================

    const PhysicalMeasurementCard = ({ measurement, packageColor }) => {
      return (
        <div
          className="p-4 rounded-xl"
          style={{
            backgroundColor: 'var(--color-bg-tag)',
            border: '1px solid var(--color-border)'
          }}
        >
          <div className="flex items-start gap-3">
            <span className="text-2xl mt-1">{measurement.emoji}</span>
            <div className="flex-1 min-w-0">
              {/* Hlavn√≠ label naho≈ôe - vƒõt≈°√≠ */}
              <div className="font-medium text-base mb-1" style={{ color: 'var(--color-text-primary)' }}>{measurement.why}</div>
              {/* Technick√Ω n√°zev dole - men≈°√≠, ≈°ed√Ω */}
              <div className="text-xs mb-2" style={{ color: 'var(--color-text-subtle)' }}>{measurement.name}</div>
              {/* Vysvƒõtlen√≠ */}
              <p className="text-sm leading-relaxed" style={{ color: 'var(--color-text-muted)' }}>{measurement.youWillSee}</p>
            </div>
          </div>
        </div>
      );
    };

    // ============================================
    // FLOW VIEW (Z√°kaznick√Ω prototyp) - NOV√Å VERZE S PROFILY
    // ============================================

    const FlowView = () => {
      const [step, setStep] = useState(0); // 0 = pro koho, 1 = persona, 2 = profil, 3 = souhrn
      const [forWhom, setForWhom] = useState(null); // 'self' nebo 'parents'
      const [selectedPersona, setSelectedPersona] = useState(null);
      const [selectedProfile, setSelectedProfile] = useState(null);
      const [selectedFrequency, setSelectedFrequency] = useState(frequencies[1]); // default 2√ó roƒçnƒõ
      const [selectedAddons, setSelectedAddons] = useState([]); // add-ony nav√≠c

      const handleForWhomSelect = (whom) => {
        setForWhom(whom);
        setStep(1);
      };

      const handlePersonaSelect = (persona) => {
        setSelectedPersona(persona);
        const profile = profiles[persona.profileId];
        setSelectedProfile(profile);
        // Nastav defaultn√≠ add-ony podle profilu
        const defaultAddons = [];
        if (profile.physicalMeasurementIds.includes('bloodPressure') || profile.physicalMeasurementIds.includes('inbody')) {
          defaultAddons.push('telMereni');
        }
        if (profile.physicalMeasurementIds.includes('gripStrength')) {
          defaultAddons.push('grip');
        }
        setSelectedAddons(defaultAddons);
        setStep(2);
      };

      const toggleAddon = (addonId) => {
        setSelectedAddons(prev =>
          prev.includes(addonId)
            ? prev.filter(id => id !== addonId)
            : [...prev, addonId]
        );
      };

      const calculateTotalPrice = (profile, frequency, addons) => {
        const basePrice = calculatePrice(profile, frequency);
        const addonsPrice = addons.reduce((sum, addonId) => {
          return sum + (measurementCategories[addonId]?.addonPrice || 0) * frequency.multiplier;
        }, 0);
        return basePrice + Math.round(addonsPrice * (1 - frequency.discount));
      };

      const resetFlow = () => {
        setStep(0);
        setForWhom(null);
        setSelectedPersona(null);
        setSelectedProfile(null);
        setSelectedFrequency(frequencies[1]);
        setSelectedAddons([]);
      };

      // Step 0: Pro koho je to?
      if (step === 0) {
        return (
          <div className="max-w-3xl mx-auto px-4 py-16 animate-fade-in-up">
            <div className="text-center mb-12">
              <KomfiLogo className="h-8 mx-auto mb-6" style={{ color: 'var(--color-text-primary)' }} />
              <h2 className="font-display text-4xl md:text-5xl mb-4" style={{ color: 'var(--color-text-primary)' }}>Vitalita</h2>
              <p className="text-lg" style={{ color: 'var(--color-text-muted)' }}>Zdravotn√≠ screening z pohodl√≠ domova</p>
            </div>

            <div className="grid md:grid-cols-2 gap-6">
              <button
                onClick={() => handleForWhomSelect('self')}
                className="p-10 rounded-2xl text-left transition-all hover:scale-[1.02] card-hover"
                style={{
                  backgroundColor: 'var(--color-bg-card)',
                  border: '1px solid var(--color-border)',
                  boxShadow: 'var(--shadow-card)'
                }}
              >
                <div className="text-5xl mb-4">üôã</div>
                <div className="font-display text-2xl mb-2" style={{ color: 'var(--color-text-primary)' }}>Chci to pro sebe</div>
                <div style={{ color: 'var(--color-text-muted)' }}>
                  Chci m√≠t p≈ôehled o sv√©m zdrav√≠ a p≈ôedej√≠t probl√©m≈Øm.
                </div>
              </button>

              <button
                onClick={() => handleForWhomSelect('parents')}
                className="p-10 rounded-2xl text-left transition-all hover:scale-[1.02] card-hover"
                style={{
                  backgroundColor: 'var(--color-bg-card)',
                  border: '1px solid var(--color-border)',
                  boxShadow: 'var(--shadow-card)'
                }}
              >
                <div className="text-5xl mb-4">üë®‚Äçüë©‚Äçüëß</div>
                <div className="font-display text-2xl mb-2" style={{ color: 'var(--color-text-primary)' }}>Star√°m se o rodiƒçe</div>
                <div style={{ color: 'var(--color-text-muted)' }}>
                  Chci m√≠t p≈ôehled o zdrav√≠ sv√Ωch bl√≠zk√Ωch a pomoct jim.
                </div>
              </button>
            </div>

            <div className="flex justify-center gap-8 mt-12 text-sm" style={{ color: 'var(--color-text-subtle)' }}>
              <span>üè† Dom√°c√≠ odbƒõry</span>
              <span>üìà Trend v ƒçase</span>
              <span>ü§ñ AI interpretace</span>
            </div>
          </div>
        );
      }

      // Step 1: Persona Selection (stejn√© volby pro obƒõ vƒõtve)
      if (step === 1) {
        // Obƒõ vƒõtve maj√≠ stejn√© 3 persony: üí™ 50-65, üè† 65-75, üè• Zhor≈°en√≠
        const filteredPersonas = personas.filter(p => p.id !== 'family');

        const headerText = forWhom === 'self'
          ? { title: 'Jak√° je va≈°e situace?', subtitle: 'Vyberte mo≈ænost, kter√° v√°m je nejbli≈æ≈°√≠' }
          : { title: 'Jak√° je situace va≈°ich bl√≠zk√Ωch?', subtitle: 'Vyberte mo≈ænost, kter√° jim je nejbli≈æ≈°√≠' };

        return (
          <div className="max-w-4xl mx-auto px-4 py-12 animate-fade-in-up">
            <button
              onClick={() => setStep(0)}
              className="mb-6 px-4 py-2 rounded-lg transition-colors"
              style={{
                backgroundColor: 'var(--color-bg-card)',
                color: 'var(--color-text-muted)',
                border: '1px solid var(--color-border)'
              }}
            >
              ‚Üê Zpƒõt
            </button>

            <div className="text-center mb-12">
              <h2 className="font-display text-3xl mb-4" style={{ color: 'var(--color-text-primary)' }}>{headerText.title}</h2>
              <p style={{ color: 'var(--color-text-muted)' }}>{headerText.subtitle}</p>
            </div>

            <div className="grid md:grid-cols-3 gap-6">
              {filteredPersonas.map((persona, index) => (
                <button
                  key={persona.id}
                  onClick={() => handlePersonaSelect(persona)}
                  className={`p-6 rounded-2xl text-left transition-all hover:scale-[1.02] card-hover animate-fade-in-up stagger-${index + 1}`}
                  style={{
                    backgroundColor: 'var(--color-bg-card)',
                    border: '1px solid var(--color-border)',
                    boxShadow: 'var(--shadow-card)'
                  }}
                >
                  <div className="text-4xl mb-3">{persona.emoji}</div>
                  <div className="font-display text-xl mb-2" style={{ color: 'var(--color-text-primary)' }}>{persona.title}</div>
                  <div className="text-sm mb-4" style={{ color: 'var(--color-text-muted)' }}>{persona.subtitle}</div>
                  <div className="flex flex-wrap gap-1">
                    {persona.concerns.map((c, i) => (
                      <span
                        key={i}
                        className="text-xs px-2 py-1 rounded-full"
                        style={{ backgroundColor: 'var(--color-terracotta-bg)', color: 'var(--color-terracotta)' }}
                      >
                        {c}
                      </span>
                    ))}
                  </div>
                </button>
              ))}
            </div>
          </div>
        );
      }

      // Step 2: Profile Detail + Frequency Selection
      if (step === 2 && selectedPersona && selectedProfile) {
        const totalPrice = calculateTotalPrice(selectedProfile, selectedFrequency, selectedAddons);
        const basePrice = calculatePrice(selectedProfile, selectedFrequency);
        const addonsTotal = totalPrice - basePrice;

        return (
          <div className="max-w-5xl mx-auto px-4 py-8 animate-fade-in-up">
            <button
              onClick={() => setStep(1)}
              className="mb-6 px-4 py-2 rounded-lg transition-colors"
              style={{
                backgroundColor: 'var(--color-bg-card)',
                color: 'var(--color-text-muted)',
                border: '1px solid var(--color-border)'
              }}
            >
              ‚Üê Zpƒõt na v√Ωbƒõr
            </button>

            {/* Persona Header */}
            <div
              className="rounded-2xl p-8 mb-6"
              style={{
                backgroundColor: 'var(--color-bg-card)',
                border: '1px solid var(--color-border)',
                boxShadow: 'var(--shadow-card)'
              }}
            >
              <div className="flex items-start gap-6">
                <div
                  className="text-5xl w-20 h-20 rounded-2xl flex items-center justify-center"
                  style={{ backgroundColor: 'var(--color-terracotta-bg)' }}
                >
                  {selectedPersona.emoji}
                </div>
                <div>
                  <h2 className="font-display text-2xl md:text-3xl mb-2" style={{ color: 'var(--color-text-primary)' }}>{selectedPersona.title}</h2>
                  <p className="mb-4" style={{ color: 'var(--color-text-muted)' }}>{selectedPersona.description}</p>
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">{selectedProfile.emoji}</span>
                    <span className="font-display text-xl" style={{ color: 'var(--color-terracotta)' }}>
                      Profil {selectedProfile.name}
                    </span>
                  </div>
                </div>
              </div>
            </div>

            {/* Va≈°e obavy ‚Üí Co mƒõ≈ô√≠me */}
            <div
              className="rounded-2xl p-6 mb-6"
              style={{
                backgroundColor: 'var(--color-bg-card)',
                border: '1px solid var(--color-border)',
                boxShadow: 'var(--shadow-card)'
              }}
            >
              <h3 className="font-display text-lg mb-4" style={{ color: 'var(--color-text-primary)' }}>
                Na z√°kladƒõ va≈°ich obav mƒõ≈ô√≠me:
              </h3>
              <div className="space-y-3">
                {selectedPersona.concerns.map((concern, i) => (
                  <div key={i} className="flex items-center gap-4 p-3 rounded-xl" style={{ backgroundColor: 'var(--color-bg-tag)' }}>
                    <span
                      className="px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap"
                      style={{ backgroundColor: 'var(--color-terracotta-bg)', color: 'var(--color-terracotta)' }}
                    >
                      {concern}
                    </span>
                    <span style={{ color: 'var(--color-text-subtle)' }}>‚Üí</span>
                    <div className="flex flex-wrap gap-2">
                      {selectedProfile.markers
                        .filter(m => {
                          const concernMap = {
                            'Cukrovka v rodinƒõ': ['Gluk√≥za', 'HbA1c'],
                            'Cholesterol': ['Cholesterol', 'LDL', 'HDL', 'Triglyceridy'],
                            'Chci z≈Østat fit': ['Krevn√≠ obraz', 'Vitamin D'],
                            '√önava a energie': ['Krevn√≠ obraz', 'B12', 'Ferritin', 'TSH'],
                            'Krevn√≠ tlak': ['tlak'],
                            'Pamƒõ≈•': ['B12', 'TSH'],
                            'K≈ôehkost a p√°dy': ['Grip', 'InBody', 'Vitamin D', 'Albumin'],
                            'V√Ω≈æiva': ['Albumin', 'Miner√°ly', 'B12'],
                            'Komplexn√≠ p≈ôehled': ['J√°tra', 'Moƒç', '≈†t√≠tn√°'],
                            'Rekonvalescence': ['CRP', 'Albumin', 'Krevn√≠ obraz'],
                            'Chronick√© nemoci': ['GFR', 'HbA1c', 'J√°tra'],
                            'Prevence p√°d≈Ø': ['Grip', 'InBody', 'Vitamin D']
                          };
                          const keywords = concernMap[concern] || [];
                          return keywords.some(kw => m.name.toLowerCase().includes(kw.toLowerCase()));
                        })
                        .slice(0, 3)
                        .map((marker, j) => (
                          <span
                            key={j}
                            className="px-2 py-1 rounded-lg text-sm"
                            style={{
                              backgroundColor: 'var(--color-bg-card)',
                              color: 'var(--color-text-secondary)',
                              border: '1px solid var(--color-border)'
                            }}
                          >
                            {getCategoryEmoji(marker.category)} {marker.name}
                          </span>
                        ))
                      }
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Profile Detail */}
            <div
              className="rounded-2xl p-8"
              style={{
                backgroundColor: 'var(--color-bg-card)',
                border: '1px solid var(--color-border)',
                boxShadow: 'var(--shadow-card)'
              }}
            >
              <div
                className="rounded-2xl p-6 md:p-8"
                style={{
                  backgroundColor: 'var(--color-bg-tag)',
                  border: '1px solid var(--color-border)'
                }}
              >
                <div className="flex flex-col md:flex-row justify-between items-start gap-4 mb-6">
                  <div>
                    <div className="flex items-center gap-3 mb-2">
                      <span className="text-3xl">{selectedProfile.emoji}</span>
                      <span className="font-display text-2xl md:text-3xl" style={{ color: 'var(--color-text-primary)' }}>{selectedProfile.name}</span>
                    </div>
                    <p style={{ color: 'var(--color-text-muted)' }}>{selectedProfile.tagline}</p>
                  </div>
                  <div className="text-right">
                    <div className="font-display text-3xl md:text-4xl" style={{ color: 'var(--color-terracotta)' }}>
                      {totalPrice} Kƒç
                    </div>
                    <div style={{ color: 'var(--color-text-subtle)' }}>za {selectedFrequency.label}</div>
                  </div>
                </div>

                {/* Frequency Selection */}
                <div className="mb-6">
                  <div className="font-medium mb-3" style={{ color: 'var(--color-text-secondary)' }}>Jak ƒçasto chcete mƒõ≈ôen√≠?</div>
                  <div className="grid grid-cols-3 gap-3">
                    {frequencies.map(freq => {
                      const isSelected = selectedFrequency.id === freq.id;
                      const price = calculateTotalPrice(selectedProfile, freq, selectedAddons);

                      return (
                        <button
                          key={freq.id}
                          onClick={() => setSelectedFrequency(freq)}
                          className={`p-4 rounded-xl text-center transition-all ${
                            isSelected ? 'scale-[1.02]' : ''
                          }`}
                          style={{
                            border: isSelected ? '2px solid var(--color-terracotta)' : '1px solid var(--color-border)',
                            backgroundColor: isSelected ? 'var(--color-terracotta-bg)' : 'var(--color-bg-card)',
                            boxShadow: isSelected ? 'var(--shadow-hover)' : 'none'
                          }}
                        >
                          <div className="font-display text-2xl mb-1" style={{ color: 'var(--color-text-primary)' }}>{freq.shortLabel}</div>
                          <div className="text-sm mb-2" style={{ color: 'var(--color-text-subtle)' }}>{freq.description}</div>
                          <div className="text-lg font-semibold" style={{ color: 'var(--color-terracotta)' }}>
                            {price} Kƒç
                          </div>
                          {freq.discount > 0 && (
                            <div className="text-xs font-medium" style={{ color: 'var(--color-sage)' }}>
                              -{Math.round(freq.discount * 100)}% sleva
                            </div>
                          )}
                        </button>
                      );
                    })}
                  </div>
                </div>

                {/* Category Blocks - Add-ons */}
                <div className="mb-6">
                  <div className="font-medium mb-3" style={{ color: 'var(--color-text-secondary)' }}>Vyberte typy mƒõ≈ôen√≠:</div>
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                    {Object.values(measurementCategories).map(cat => {
                      const isIncluded = cat.baseIncluded || selectedAddons.includes(cat.id);
                      const isBase = cat.baseIncluded;

                      return (
                        <button
                          key={cat.id}
                          onClick={() => !isBase && toggleAddon(cat.id)}
                          disabled={isBase}
                          className={`p-4 rounded-xl text-center transition-all ${
                            isIncluded ? '' : 'opacity-60 hover:opacity-80'
                          } ${isBase ? 'cursor-default' : 'cursor-pointer'}`}
                          style={{
                            border: isIncluded ? '2px solid var(--color-terracotta)' : '1px solid var(--color-border)',
                            backgroundColor: isIncluded ? 'var(--color-terracotta-bg)' : 'var(--color-bg-card)',
                            boxShadow: isIncluded ? 'var(--shadow-card)' : 'none'
                          }}
                        >
                          <div className="text-3xl mb-2">{cat.emoji}</div>
                          <div className="font-medium text-sm" style={{ color: 'var(--color-text-primary)' }}>{cat.name}</div>
                          <div className="text-xs mt-1" style={{ color: 'var(--color-text-subtle)' }}>{cat.description}</div>
                          {isBase ? (
                            <div className="text-xs font-medium mt-2" style={{ color: 'var(--color-terracotta)' }}>
                              ‚úì Zahrnuto
                            </div>
                          ) : (
                            <div className="text-xs font-medium mt-2" style={{ color: isIncluded ? 'var(--color-terracotta)' : 'var(--color-text-subtle)' }}>
                              {isIncluded ? '‚úì P≈ôid√°no' : `+${cat.addonPrice} Kƒç`}
                            </div>
                          )}
                        </button>
                      );
                    })}
                  </div>
                  {addonsTotal > 0 && (
                    <div className="mt-3 text-sm text-right" style={{ color: 'var(--color-text-subtle)' }}>
                      Add-ony celkem: <span className="font-medium">+{addonsTotal} Kƒç</span>
                    </div>
                  )}
                </div>

                {/* Co mƒõ≈ô√≠me - V≈ΩDY ROZBALENO */}
                <div
                  className="rounded-xl p-4 mb-6"
                  style={{ backgroundColor: 'var(--color-bg-card)', border: '1px solid var(--color-border)' }}
                >
                  <div className="font-display text-lg mb-4" style={{ color: 'var(--color-text-primary)' }}>
                    üß™ Co mƒõ≈ô√≠me
                  </div>

                  <div className="space-y-6">
                    {/* Krevn√≠ testy */}
                    <div>
                      <div className="flex items-center gap-2 mb-3">
                        <span className="text-lg">ü©∏</span>
                        <span className="font-medium" style={{ color: 'var(--color-text-secondary)' }}>Krevn√≠ testy</span>
                        <span className="text-xs" style={{ color: 'var(--color-text-subtle)' }}>({selectedProfile.markers.length})</span>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                        {selectedProfile.markers.map((marker, i) => (
                          <MarkerCard key={i} marker={marker} packageColor={selectedProfile.color} />
                        ))}
                      </div>
                    </div>

                    {/* Tƒõlesn√° mƒõ≈ôen√≠ - pokud je addon vybr√°n */}
                    {selectedAddons.includes('telMereni') && (
                      <div>
                        <div className="flex items-center gap-2 mb-3">
                          <span className="text-lg">üìè</span>
                          <span className="font-medium" style={{ color: 'var(--color-text-secondary)' }}>Tƒõlesn√° mƒõ≈ôen√≠</span>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          <PhysicalMeasurementCard measurement={physicalMeasurements.bloodPressure} packageColor={selectedProfile.color} />
                          <PhysicalMeasurementCard measurement={physicalMeasurements.inbody} packageColor={selectedProfile.color} />
                        </div>
                      </div>
                    )}

                    {/* Grip strength - pokud je addon vybr√°n */}
                    {selectedAddons.includes('grip') && (
                      <div>
                        <div className="flex items-center gap-2 mb-3">
                          <span className="text-lg">‚úä</span>
                          <span className="font-medium" style={{ color: 'var(--color-text-secondary)' }}>S√≠la stisku</span>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          <PhysicalMeasurementCard measurement={physicalMeasurements.gripStrength} packageColor={selectedProfile.color} />
                        </div>
                      </div>
                    )}

                    {/* Kognitivn√≠ testy - pokud je addon vybr√°n */}
                    {selectedAddons.includes('kognitivni') && (
                      <div>
                        <div className="flex items-center gap-2 mb-3">
                          <span className="text-lg">üß†</span>
                          <span className="font-medium" style={{ color: 'var(--color-text-secondary)' }}>Kognitivn√≠ testy</span>
                        </div>
                        <div className="p-4 rounded-xl" style={{ backgroundColor: 'var(--color-bg-tag)', border: '1px solid var(--color-border)' }}>
                          <div className="font-medium mb-1" style={{ color: 'var(--color-text-primary)' }}>Pamƒõ≈• a koncentrace</div>
                          <div className="text-xs mb-2" style={{ color: 'var(--color-text-subtle)' }}>Kognitivn√≠ screening</div>
                          <p className="text-sm" style={{ color: 'var(--color-text-muted)' }}>
                            Kr√°tk√Ω test pamƒõti a pozornosti. Uvid√≠te sk√≥re a srovn√°n√≠ s vƒõkovou skupinou. Pom√°h√° odhalit ran√© zn√°mky kognitivn√≠ho poklesu.
                          </p>
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                {/* Output */}
                <div className="rounded-xl p-6 mb-6" style={{ backgroundColor: 'var(--color-bg-card)', border: '1px solid var(--color-border)' }}>
                  <div className="font-medium mb-3" style={{ color: 'var(--color-text-primary)' }}>üìã Co dostanete:</div>
                  <div className="flex flex-wrap gap-2">
                    {selectedProfile.output.map((item, i) => (
                      <span key={i} className="px-4 py-2 rounded-lg text-sm" style={{ backgroundColor: 'var(--color-bg-tag)', color: 'var(--color-text-secondary)' }}>
                        ‚úì {item}
                      </span>
                    ))}
                  </div>
                </div>

                {/* CTA */}
                <button
                  onClick={() => setStep(3)}
                  className="w-full py-5 rounded-xl text-white text-lg font-semibold transition-all btn-primary"
                  style={{
                    background: 'linear-gradient(135deg, var(--color-terracotta) 0%, var(--color-terracotta-dark) 100%)',
                    boxShadow: '0 12px 40px rgba(198, 124, 78, 0.3)'
                  }}
                >
                  <span>Pokraƒçovat k objedn√°vce ‚Üí</span>
                </button>
              </div>

              {/* Bistro Upsell */}
              <div
                className="mt-6 rounded-2xl p-6 flex flex-col md:flex-row items-center gap-6"
                style={{
                  backgroundColor: 'var(--color-terracotta-bg)',
                  border: '1px solid var(--color-border)'
                }}
              >
                <div className="text-4xl">üçΩÔ∏è</div>
                <div className="flex-1 text-center md:text-left">
                  <div className="font-display text-lg" style={{ color: 'var(--color-text-primary)' }}>M√°te Komfi Bistro?</div>
                  <div style={{ color: 'var(--color-text-muted)' }}>
                    Propojte Vitalitu s j√≠deln√≠ƒçkem. Dostanete personalizovan√° v√Ω≈æivov√° doporuƒçen√≠.
                  </div>
                </div>
                <div className="px-6 py-3 rounded-xl text-white font-semibold whitespace-nowrap" style={{ backgroundColor: 'var(--color-terracotta)' }}>
                  Bundle: -20%
                </div>
              </div>
            </div>
          </div>
        );
      }

      // Step 3: Summary
      if (step === 3 && selectedProfile) {
        const totalPrice = calculateTotalPrice(selectedProfile, selectedFrequency, selectedAddons);
        const addonsCount = selectedAddons.length;

        return (
          <div className="min-h-screen flex items-center justify-center p-8 animate-scale-in">
            <div className="max-w-lg rounded-3xl p-8 md:p-12 text-center" style={{ backgroundColor: 'var(--color-bg-card)', boxShadow: 'var(--shadow-hover)' }}>
              <div
                className="w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center text-4xl text-white"
                style={{ background: 'linear-gradient(135deg, var(--color-terracotta) 0%, var(--color-terracotta-dark) 100%)' }}
              >
                ‚úì
              </div>
              <h2 className="font-display text-3xl mb-4" style={{ color: 'var(--color-text-primary)' }}>Skvƒõl√° volba!</h2>
              <p className="mb-8" style={{ color: 'var(--color-text-muted)' }}>
                Profil <strong style={{ color: 'var(--color-terracotta)' }}>{selectedProfile.name}</strong> s frekvenc√≠ <strong>{selectedFrequency.label}</strong> je ide√°ln√≠ pro va≈°i situaci.
              </p>

              <div className="rounded-2xl p-6 mb-8" style={{ backgroundColor: 'var(--color-bg-tag)' }}>
                <div className="mb-2" style={{ color: 'var(--color-text-subtle)' }}>{selectedFrequency.label}</div>
                <div className="font-display text-4xl md:text-5xl mb-1" style={{ color: 'var(--color-terracotta)' }}>{totalPrice} Kƒç</div>
                <div style={{ color: 'var(--color-text-muted)' }}>
                  = {selectedProfile.markers.length} krevn√≠ch test≈Ø{addonsCount > 0 ? ` + ${addonsCount} dopl≈àkov√° mƒõ≈ôen√≠` : ''}
                </div>
                {selectedAddons.length > 0 && (
                  <div className="flex flex-wrap justify-center gap-2 mt-3">
                    {selectedAddons.map(addonId => (
                      <span key={addonId} className="px-2 py-1 rounded-lg text-xs" style={{ backgroundColor: 'var(--color-bg-card)', color: 'var(--color-text-secondary)', border: '1px solid var(--color-border)' }}>
                        {measurementCategories[addonId].emoji} {measurementCategories[addonId].name}
                      </span>
                    ))}
                  </div>
                )}
              </div>

              <div className="flex gap-4">
                <button
                  onClick={() => setStep(2)}
                  className="flex-1 py-4 rounded-xl font-medium transition-colors"
                  style={{ border: '1px solid var(--color-border)', color: 'var(--color-text-muted)', backgroundColor: 'var(--color-bg-card)' }}
                >
                  ‚Üê Zpƒõt
                </button>
                <button
                  className="flex-[2] py-4 rounded-xl text-white font-semibold transition-all btn-primary"
                  style={{ background: 'linear-gradient(135deg, var(--color-terracotta) 0%, var(--color-terracotta-dark) 100%)' }}
                >
                  <span>Objednat üè†</span>
                </button>
              </div>

              <p className="text-sm mt-6" style={{ color: 'var(--color-text-subtle)' }}>
                Kit doruƒç√≠me do 3 dn≈Ø. V√Ωsledky do 5 dn≈Ø od odbƒõru.
              </p>
            </div>
          </div>
        );
      }

      return null;
    };

    // ============================================
    // ANALYSIS VIEW
    // ============================================

    const AnalysisView = () => (
      <div className="max-w-5xl mx-auto px-4 py-12">
        <h2 className="text-3xl font-bold text-slate-800 mb-8 text-center">üìä Kritick√° anal√Ωza a doporuƒçen√≠</h2>

        {/* Overview */}
        <div className="bg-white rounded-2xl p-8 shadow-lg mb-8">
          <h3 className="text-2xl font-bold text-slate-800 mb-4">üéØ Kl√≠ƒçov√© ot√°zky</h3>
          <div className="grid md:grid-cols-2 gap-6">
            <div>
              <h4 className="font-bold text-emerald-600 mb-2">Co d√°v√° smysl?</h4>
              <ul className="space-y-2 text-slate-600">
                <li>‚úÖ <strong>Trend > jednotliv√° mƒõ≈ôen√≠</strong> - hlavn√≠ diferenci√°tor</li>
                <li>‚úÖ <strong>Propojen√≠ s Bistro</strong> - unik√°tn√≠ hodnota</li>
                <li>‚úÖ <strong>Dom√°c√≠ odbƒõry</strong> - pohodl√≠ pro seniory</li>
                <li>‚úÖ <strong>Jasn√° interpretace</strong> - ne jen ƒç√≠sla</li>
              </ul>
            </div>
            <div>
              <h4 className="font-bold text-red-500 mb-2">Rizika / Ot√°zky</h4>
              <ul className="space-y-2 text-slate-600">
                <li>‚ö†Ô∏è <strong>Komplexita bal√≠ƒçk≈Ø</strong> - p≈ô√≠li≈° mnoho marker≈Ø v Dohledu?</li>
                <li>‚ö†Ô∏è <strong>Cenov√° citlivost</strong> - 50+ jsou cenovƒõ citliv√≠</li>
                <li>‚ö†Ô∏è <strong>Konkurence</strong> - EUC, Synlab maj√≠ podobn√© slu≈æby</li>
                <li>‚ö†Ô∏è <strong>Regulace</strong> - dom√°c√≠ odbƒõry maj√≠ limity</li>
              </ul>
            </div>
          </div>
        </div>

        {/* Package Analysis */}
        <div className="bg-white rounded-2xl p-8 shadow-lg mb-8">
          <h3 className="text-2xl font-bold text-slate-800 mb-6">üì¶ Anal√Ωza bal√≠ƒçk≈Ø</h3>

          <div className="space-y-6">
            {/* P≈ôehled */}
            <div className="border-l-4 border-emerald-500 pl-6">
              <div className="flex items-center gap-3 mb-2">
                <span className="text-3xl">üü¢</span>
                <span className="text-xl font-bold text-slate-800">P≈òEHLED (890 Kƒç)</span>
                <span className="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm">üëç Doporuƒçeno</span>
              </div>
              <div className="grid md:grid-cols-2 gap-4 text-sm">
                <div>
                  <strong className="text-emerald-600">Pro:</strong>
                  <ul className="text-slate-600 mt-1 space-y-1">
                    <li>‚Ä¢ N√≠zk√° cena = n√≠zk√° bari√©ra vstupu</li>
                    <li>‚Ä¢ 6 kl√≠ƒçov√Ωch marker≈Ø pokr√Ωv√° hlavn√≠ rizika</li>
                    <li>‚Ä¢ Ide√°ln√≠ pro "mlad≈°√≠" 50-65</li>
                    <li>‚Ä¢ Skvƒõl√Ω wedge produkt</li>
                  </ul>
                </div>
                <div>
                  <strong className="text-red-500">Proti:</strong>
                  <ul className="text-slate-600 mt-1 space-y-1">
                    <li>‚Ä¢ Mo≈æn√° p≈ô√≠li≈° jednoduch√Ω pro 65+</li>
                    <li>‚Ä¢ Chyb√≠ lipidov√Ω panel (jen celkov√Ω cholesterol)</li>
                  </ul>
                  <strong className="text-blue-600 mt-3 block">Doporuƒçen√≠:</strong>
                  <p className="text-slate-600">P≈ôidat LDL/HDL, ztrat√≠te diferenciaci Kontroly</p>
                </div>
              </div>
            </div>

            {/* Kontrola */}
            <div className="border-l-4 border-amber-500 pl-6">
              <div className="flex items-center gap-3 mb-2">
                <span className="text-3xl">üü°</span>
                <span className="text-xl font-bold text-slate-800">KONTROLA (1490 Kƒç)</span>
                <span className="px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-sm">‚ö° Sweet spot</span>
              </div>
              <div className="grid md:grid-cols-2 gap-4 text-sm">
                <div>
                  <strong className="text-emerald-600">Pro:</strong>
                  <ul className="text-slate-600 mt-1 space-y-1">
                    <li>‚Ä¢ Kompletn√≠ kardio + diabetes profil</li>
                    <li>‚Ä¢ HbA1c je killer feature (3-mƒõs√≠ƒçn√≠ pr≈Ømƒõr)</li>
                    <li>‚Ä¢ Propojen√≠ s Bistro d√°v√° smysl</li>
                    <li>‚Ä¢ Dobr√Ω pomƒõr cena/hodnota</li>
                  </ul>
                </div>
                <div>
                  <strong className="text-red-500">Proti:</strong>
                  <ul className="text-slate-600 mt-1 space-y-1">
                    <li>‚Ä¢ 14 marker≈Ø m≈Ø≈æe b√Ωt overwhelming</li>
                    <li>‚Ä¢ Moƒç chemicky - pot≈ôebujete to opravdu?</li>
                  </ul>
                  <strong className="text-blue-600 mt-3 block">Doporuƒçen√≠:</strong>
                  <p className="text-slate-600">Toto by mƒõl b√Ωt v√°≈° hlavn√≠ produkt. Mo≈æn√° p≈ôejmenovat na "STANDARD"?</p>
                </div>
              </div>
            </div>

            {/* Dohled */}
            <div className="border-l-4 border-red-500 pl-6">
              <div className="flex items-center gap-3 mb-2">
                <span className="text-3xl">üî¥</span>
                <span className="text-xl font-bold text-slate-800">DOHLED (2490 Kƒç)</span>
                <span className="px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm">ü§î Ke zv√°≈æen√≠</span>
              </div>
              <div className="grid md:grid-cols-2 gap-4 text-sm">
                <div>
                  <strong className="text-emerald-600">Pro:</strong>
                  <ul className="text-slate-600 mt-1 space-y-1">
                    <li>‚Ä¢ Komplexn√≠ pro v√°≈æn√© p≈ô√≠pady</li>
                    <li>‚Ä¢ 15min konzultace je siln√° hodnota</li>
                    <li>‚Ä¢ Sd√≠len√≠ s l√©ka≈ôem - diferenci√°tor</li>
                    <li>‚Ä¢ 4√ó roƒçnƒõ = skuteƒçn√Ω monitoring</li>
                  </ul>
                </div>
                <div>
                  <strong className="text-red-500">Proti:</strong>
                  <ul className="text-slate-600 mt-1 space-y-1">
                    <li>‚Ä¢ 20+ marker≈Ø je hodnƒõ na interpretaci</li>
                    <li>‚Ä¢ Roƒçn√≠ cena 8960 Kƒç je vysok√°</li>
                    <li>‚Ä¢ PSA kontroverzn√≠ (fale≈°n√° pozitiva)</li>
                    <li>‚Ä¢ Miner√°ly selektivnƒõ - kter√©?</li>
                  </ul>
                  <strong className="text-blue-600 mt-3 block">Doporuƒçen√≠:</strong>
                  <p className="text-slate-600">Zv√°≈æit split: DOHLED (bez PSA) + DOHLED MU≈ΩI (s PSA)</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* Pricing Analysis */}
        <div className="bg-white rounded-2xl p-8 shadow-lg mb-8">
          <h3 className="text-2xl font-bold text-slate-800 mb-6">üí∞ Cenov√° anal√Ωza</h3>

          <div className="overflow-x-auto">
            <table className="w-full text-sm">
              <thead>
                <tr className="border-b-2">
                  <th className="text-left py-3">Bal√≠ƒçek</th>
                  <th className="text-right py-3">Jednor√°zovƒõ</th>
                  <th className="text-right py-3">Roƒçnƒõ</th>
                  <th className="text-right py-3">Mƒõs√≠ƒçnƒõ</th>
                  <th className="text-right py-3">Per marker</th>
                  <th className="text-center py-3">Hodnocen√≠</th>
                </tr>
              </thead>
              <tbody>
                <tr className="border-b">
                  <td className="py-3 font-medium">üü¢ P≈òEHLED</td>
                  <td className="text-right">890 Kƒç</td>
                  <td className="text-right">1580 Kƒç</td>
                  <td className="text-right text-emerald-600 font-bold">132 Kƒç</td>
                  <td className="text-right">148 Kƒç</td>
                  <td className="text-center">‚úÖ OK</td>
                </tr>
                <tr className="border-b bg-amber-50">
                  <td className="py-3 font-medium">üü° KONTROLA</td>
                  <td className="text-right">1490 Kƒç</td>
                  <td className="text-right">2680 Kƒç</td>
                  <td className="text-right text-amber-600 font-bold">223 Kƒç</td>
                  <td className="text-right">107 Kƒç</td>
                  <td className="text-center">‚≠ê Best value</td>
                </tr>
                <tr>
                  <td className="py-3 font-medium">üî¥ DOHLED</td>
                  <td className="text-right">2490 Kƒç</td>
                  <td className="text-right">8960 Kƒç</td>
                  <td className="text-right text-red-600 font-bold">747 Kƒç</td>
                  <td className="text-right">124 Kƒç</td>
                  <td className="text-center">‚ö†Ô∏è Premium</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div className="mt-6 p-4 bg-blue-50 rounded-xl">
            <strong className="text-blue-800">üí° Insight:</strong>
            <p className="text-blue-700 mt-1">
              KONTROLA m√° nejlep≈°√≠ hodnotu per marker (107 Kƒç). Ale DOHLED mƒõs√≠ƒçnƒõ (747 Kƒç)
              m≈Ø≈æe b√Ωt moc na d≈Øchodce. Zv√°≈æit ni≈æ≈°√≠ frekvenci nebo ni≈æ≈°√≠ cenu.
            </p>
          </div>
        </div>

        {/* Recommendations */}
        <div className="bg-gradient-to-br from-emerald-500 to-blue-600 rounded-2xl p-8 text-white">
          <h3 className="text-2xl font-bold mb-6">üöÄ Doporuƒçen√≠ pro Komfi Vitalita</h3>

          <div className="grid md:grid-cols-2 gap-6">
            <div className="bg-white/10 backdrop-blur rounded-xl p-6">
              <h4 className="font-bold text-lg mb-3">1. Zjednodu≈°it komunikaci</h4>
              <ul className="space-y-2 text-emerald-100">
                <li>‚Ä¢ "Dr≈æ√≠ tƒõlo?" ‚Üí "Jak jsem na tom?"</li>
                <li>‚Ä¢ M√©nƒõ technick√Ωch term√≠n≈Ø</li>
                <li>‚Ä¢ Semafor report jako hlavn√≠ v√Ωstup</li>
              </ul>
            </div>
            <div className="bg-white/10 backdrop-blur rounded-xl p-6">
              <h4 className="font-bold text-lg mb-3">2. Pos√≠lit diferenciaci</h4>
              <ul className="space-y-2 text-emerald-100">
                <li>‚Ä¢ TREND je killer feature - zd≈Øraznit</li>
                <li>‚Ä¢ Propojen√≠ Bistro ‚Üí Vitalita ‚Üí ≈Ωiviny</li>
                <li>‚Ä¢ "Va≈°e data, v√°≈° pl√°n"</li>
              </ul>
            </div>
            <div className="bg-white/10 backdrop-blur rounded-xl p-6">
              <h4 className="font-bold text-lg mb-3">3. Cenov√° strategie</h4>
              <ul className="space-y-2 text-emerald-100">
                <li>‚Ä¢ Entry: 599 Kƒç (3 markery) - z√≠skat data</li>
                <li>‚Ä¢ Standard: 1290 Kƒç (KONTROLA)</li>
                <li>‚Ä¢ Premium: 1990 Kƒç (DOHLED 2√ó roƒçnƒõ)</li>
              </ul>
            </div>
            <div className="bg-white/10 backdrop-blur rounded-xl p-6">
              <h4 className="font-bold text-lg mb-3">4. Go-to-market</h4>
              <ul className="space-y-2 text-emerald-100">
                <li>‚Ä¢ Zaƒç√≠t s Bistro klienty (warm leads)</li>
                <li>‚Ä¢ Bundle Bistro + Vitalita (-20%)</li>
                <li>‚Ä¢ Obce jako B2B kan√°l</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    );

    // ============================================
    // RENDER
    // ============================================

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
